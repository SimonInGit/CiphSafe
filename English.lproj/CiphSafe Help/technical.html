<html>
<head>
<title>CiphSafe Help</title>
<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
<meta name="copyright" content="Copyright 2003 Bryan L. Blackburn. All Rights Reserved.">
<meta name="DESCRIPTION" content="Describes the technical details of CiphSafe">
</head>

<body>
<img src="icon64.jpg"><a href="index.html">CiphSafe Help</a>
<h1>CiphSafe Technical Information</h1>
<p>
CiphSafe saves each document using the
<a href="http://www.counterpane.com/bfsverlag.html">Blowfish</a> cipher,
using a 320 bit key, in cipher block chaining mode.

<p>
The key is created by splitting the passphrase into two halves, then
calculating the SHA-1 hash for each half.  Since SHA-1 generates a 160 bit
result, this is where the 320 bit keysize originates.

<p>
Both the Blowfish and SHA-1 algorithms are not actually in the application,
however, as CiphSafe uses the <a href="http://www.openssl.org">OpenSSL</a>
library (shipped with Mac OS X) to perform this work.

<p>
Since CiphSafe uses cipher block chaining, it requires an initialization
vector (IV).  The IV is simply eight random bytes, grabbed from the
/dev/random device.  It is then saved as the first part of the resulting
file.

<p>
The data saved to disk is first passed to Cocoa's NSArchiver to generate
a bunch of bytes from all the entries in the document.  These bytes are
then compressed with <a href="http://www.gzip.org/zlib/">zlib</a>, and
finally encrypted using the key and the random IV.  This causes each save to
be quite different from the previous, even if no entries have been changed,
as a new IV is created.

</body>
</html>

